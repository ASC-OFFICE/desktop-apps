/*
 * Copyright (c) Ascensio System SIA 2016. All rights reserved
 *
 * http://www.onlyoffice.com
 *
 * Version: 4.6.0 (build:762)
 */
if(void 0===Common)var Common={};if(Common.Gateway=new function(){var a=this,b=$(a),c={init:function(a){b.trigger("init",a)},openDocument:function(a){b.trigger("opendocument",a)},showMessage:function(a){b.trigger("showmessage",a)},applyEditRights:function(a){b.trigger("applyeditrights",a)},processSaveResult:function(a){b.trigger("processsaveresult",a)},processRightsChange:function(a){b.trigger("processrightschange",a)},refreshHistory:function(a){b.trigger("refreshhistory",a)},setHistoryData:function(a){b.trigger("sethistorydata",a)},setEmailAddresses:function(a){b.trigger("setemailaddresses",a)},processMailMerge:function(a){b.trigger("processmailmerge",a)},downloadAs:function(){b.trigger("downloadas")},processMouse:function(a){b.trigger("processmouse",a)},internalCommand:function(a){b.trigger("internalcommand",a)},resetFocus:function(a){b.trigger("resetfocus",a)}},d=function(a){window.parent&&window.JSON&&window.parent.postMessage(window.JSON.stringify(a),"*")},e=function(a){var b=a.data;if("[object String]"===Object.prototype.toString.apply(b)&&window.JSON){var d,e;try{d=window.JSON.parse(b)}catch(f){d=""}d&&(e=c[d.command],e&&e.call(this,d.data))}},f=function(a){e(a)};return window.attachEvent?window.attachEvent("onmessage",f):window.addEventListener("message",f,!1),{ready:function(){d({event:"onReady"})},save:function(a){d({event:"onSave",data:a})},requestEditRights:function(){d({event:"onRequestEditRights"})},requestHistory:function(){d({event:"onRequestHistory"})},requestHistoryData:function(a){d({event:"onRequestHistoryData",data:a})},requestEmailAddresses:function(){d({event:"onRequestEmailAddresses"})},requestStartMailMerge:function(){d({event:"onRequestStartMailMerge"})},requestHistoryClose:function(){d({event:"onRequestHistoryClose"})},reportError:function(a,b){d({event:"onError",data:{errorCode:a,errorDescription:b}})},sendInfo:function(a){d({event:"onInfo",data:a})},setDocumentModified:function(a){d({event:"onDocumentStateChange",data:a})},internalMessage:function(a,b){d({event:"onInternalMessage",data:{type:a,data:b}})},updateVersion:function(){d({event:"onOutdatedVersion"})},downloadAs:function(a){d({event:"onDownloadAs",data:a})},collaborativeChanges:function(){d({event:"onCollaborativeChanges"})},on:function(c,d){var e=function(b,c){d.call(a,c)};b.on(c,e)}}},void 0===Common)var Common={};Common.component=Common.component||{},Common.Analytics=Common.component.Analytics=new function(){var a;return{initialize:function(b,c){if("undefined"==typeof b)throw"Analytics: invalid id.";if("undefined"==typeof c||"[object String]"!==Object.prototype.toString.apply(c))throw"Analytics: invalid category type.";a=c,$("head").append('<script type="text/javascript">var _gaq = _gaq || [];_gaq.push(["_setAccount", "'+b+'"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);})();</script>')},trackEvent:function(b,c,d){if("undefined"!=typeof b&&"[object String]"!==Object.prototype.toString.apply(b))throw"Analytics: invalid action type.";if("undefined"!=typeof c&&"[object String]"!==Object.prototype.toString.apply(c))throw"Analytics: invalid label type.";if("undefined"!=typeof d&&("[object Number]"!==Object.prototype.toString.apply(d)||!isFinite(d)))throw"Analytics: invalid value type.";if("undefined"!=typeof _gaq){if("undefined"===a)throw"Analytics is not initialized.";_gaq.push(["_trackEvent",a,b,c,d])}}}};var ApplicationView=new function(){function a(){$("#id-btn-share").popover({trigger:"manual",html:!0,template:'<div class="popover share" id="id-popover-share"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>',content:'<div class="share-link"><span class="caption">Link:</span><input id="id-short-url" class="input-xs form-control" readonly/><button id="id-btn-copy-short" type="button" class="btn btn-xs btn-primary" style="width: 65px;" data-copied-text="Copied">Copy</button></div> <div class="share-buttons" style="height: 25px" id="id-popover-social-container" data-loaded="false"><ul></ul></div>'}).popover("show"),$("#id-btn-embed").popover({trigger:"manual",html:!0,template:'<div class="popover embed" id="id-popover-embed"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>',content:'<div class="size-manual"><span class="caption">Width:</span><input id="id-input-embed-width" class="form-control input-xs" type="text" value="400px"><input id="id-input-embed-height" class="form-control input-xs right" type="text" value="600px"><span class="right caption">Height:</span></div><textarea id="id-textarea-embed" rows="4" class="form-control" readonly></textarea><button id="id-btn-copy-embed" type="button" class="btn btn-xs btn-primary" data-copied-text="Copied">Copy</button>'}).popover("show"),$("body").popover({trigger:"manual",html:!0,animation:!1,template:'<div class="popover hyperlink" id="id-tip-hyperlink"><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>',content:"<br><b>Press Ctrl and click link</b>"}).popover("show")}return{create:a}},ApplicationController=new function(){function a(a,b,c,d){return function(){var e;return function(){var f=this;e&&(clearTimeout(e),e=null),e=setTimeout(function(){a.apply(c||f,d||arguments)},b)}}()}function b(){var a=$("#id-popover-social-container");a.length>0&&"false"==a.attr("data-loaded")&&("undefined"!=typeof FB&&FB.XFBML&&FB.XFBML.parse(),"undefined"!=typeof twttr&&twttr.widgets&&twttr.widgets.load(),a.attr("data-loaded","true"))}function c(a){H=$.extend(H,a.config),J=$.extend(J,a.config.embedded),$("#id-short-url").val(J.shareUrl||"Unavailable"),$("#id-textarea-embed").text(P.replace("{embed-url}",J.embedUrl).replace("{width}",N).replace("{height}",O)),"undefined"!=typeof J.shareUrl&&""!=J.shareUrl&&(!function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/all.js#xfbml=1",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"),!function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//platform.twitter.com/widgets.js",e.parentNode.insertBefore(d,e))}(document,"script","twitter-wjs"),$("#id-popover-social-container ul")&&($("#id-popover-social-container ul").append('<li><div class="fb-like" data-href="'+J.shareUrl+'" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div></li>'),$("#id-popover-social-container ul").append('<li class="share-twitter"><a href="https://twitter.com/share" class="twitter-share-button" data-url="'+J.shareUrl+'">Tweet</a></li>'),$("#id-popover-social-container ul").append('<li class="share-mail"><a class="btn btn-xs btn-default" href="mailto:?subject=I have shared a document with you: '+J.docTitle+"&body=I have shared a document with you: "+J.shareUrl+'"><span class="glyphicon glyphicon-envelope"></span>Email</a></li>'))),"undefined"==typeof J.shareUrl&&$("#id-btn-share").hide(),"undefined"==typeof J.embedUrl&&$("#id-btn-embed").hide(),"undefined"==typeof J.fullscreenUrl&&$("#id-btn-fullscreen").hide(),H.canBackToFolder!==!1&&H.customization&&H.customization.goback&&H.customization.goback.url||$("#id-btn-close").hide(),"top"===J.toolbarDocked?($("#toolbar").addClass("top"),$("#editor_sdk").addClass("top")):($("#toolbar").addClass("bottom"),$("#editor_sdk").addClass("bottom")),$("#id-btn-fullscreen").is(":visible")||$("#id-btn-close").is(":visible")||($("#toolbar .right .separator").hide(),$("#pages").css("margin-right","12px"))}function d(a){if(I=a.doc){K=$.extend(K,I.permissions);var b=new CDocInfo;b.put_Id(I.key),b.put_Url(I.url),b.put_Title(I.title),b.put_Format(I.fileType),b.put_VKey(I.vkey),G&&(G.asc_registerCallback("asc_onGetEditorPermissions",r),G.asc_setDocInfo(b),G.asc_getEditorPermissions(H.licenseUrl,H.customerId),G.asc_enableKeyEvents(!0),Common.Analytics.trackEvent("Load","Start")),"undefined"==typeof J.saveUrl&&K.print===!1&&$("#id-btn-copy").hide(),$("#id-btn-copy").is(":visible")||$("#id-btn-share").is(":visible")||$("#id-btn-embed").is(":visible")||$("#toolbar .left .separator").hide()}}function e(a){L=a,$("#pages").text("of "+a)}function f(a){$("#page-number").val(a+1),S=a}function g(a){if(a){var b=window.open(a,"_blank");b&&b.focus()}}function h(a,b){var c="";switch(b){case c_oAscAsyncAction.Print:c="Downloading document...";break;default:c="Please wait..."}a==c_oAscAsyncActionType.BlockInteraction&&($("#id-loadmask .cmd-loader-title").html(c),s())}function i(){t()}function j(){F.isHideBodyTip=!0}function k(){if(F.isHideBodyTip){var a=$("#id-tip-hyperlink");a.length>0&&a.hide()}}function l(a){if(a&&1==a.get_Type()){F.isHideBodyTip=!1;var b=$("#id-tip-hyperlink"),c=a.get_Hyperlink(),d=c.get_ToolTip()?c.get_ToolTip():c.get_Value();b.length>0&&(b.find(".popover-content p").html(htmlEncode(d)+"<br><b>Press Ctrl and click link</b>"),b.show()),b.css({left:a.get_X()-10,top:a.get_Y()-25})}}function m(a){Common.Gateway.downloadAs(a)}function n(){G&&K.print!==!1&&G.asc_Print($.browser.chrome||$.browser.safari||$.browser.opera)}function o(a){T||(T=document.createElement("iframe"),T.id="id-print-frame",T.style.display="none",T.style.visibility="hidden",T.style.position="fixed",T.style.right="0",T.style.bottom="0",document.body.appendChild(T),T.onload=function(){T.contentWindow.focus(),T.contentWindow.print()}),a&&(T.src=a)}function p(){$("#loading-mask").fadeOut("slow")}function q(){B($("#id-popover-share"),!1),B($("#id-popover-embed"),!1),$("#id-tip-hyperlink").hide(),W(),G&&(G.ShowThumbnails(!1),G.asc_DeleteVerticalScroll()),p(),Common.Analytics.trackEvent("Load","Complete")}function r(a){if(a.asc_getCanBranding()&&"object"==typeof H.customization&&H.customization&&H.customization.logo){var b=$("#header-logo");H.customization.logo.imageEmbedded&&(b.html('<img src="'+H.customization.logo.imageEmbedded+'" style="max-width:124px; max-height:20px;"/>'),b.css({"background-image":"none",width:"auto",height:"auto"})),H.customization.logo.url&&b.attr("href",H.customization.logo.url)}G.asc_setViewMode(!0),G.asc_LoadDocument(),G.Resize(),G.zoomFitToPage()}function s(){$("#id-loadmask").modal({backdrop:"static",keyboard:!1})}function t(){$("#id-loadmask").modal("hide")}function u(a){var b=(a.asc_getCurrentFont()+a.asc_getCurrentImage())/(a.asc_getFontsCount()+a.asc_getImagesCount());$("#loadmask-text").html("Loading document: "+Math.min(Math.round(100*b),100)+"%")}function v(a,b){p();var c;switch(a){case c_oAscError.ID.Unknown:c=F.unknownErrorText;break;case c_oAscError.ID.ConvertationTimeout:c=F.convertationTimeoutText;break;case c_oAscError.ID.ConvertationError:c=F.convertationErrorText;break;case c_oAscError.ID.DownloadError:c=F.downloadErrorText;break;default:c=F.errorDefaultMessage.replace("%1",a)}b==c_oAscError.Level.Critical?(Common.Gateway.reportError(a,c),$("#id-critical-error-title").text(F.criticalErrorTitle),$("#id-critical-error-message").text(c),$("#id-critical-error-close").off(),$("#id-critical-error-close").on("click",function(){window.location.reload()})):($("#id-critical-error-title").text(F.notcriticalErrorTitle),$("#id-critical-error-message").text(c),$("#id-critical-error-close").off(),$("#id-critical-error-close").on("click",function(){$("#id-critical-error-dialog").modal("hide")})),$("#id-critical-error-dialog").modal("show"),Common.Analytics.trackEvent("Internal Error",a.toString())}function w(a){a&&(p(),$("#id-error-mask-title").text(a.title),$("#id-error-mask-text").text(a.msg),$("#id-error-mask").css("display","block"),Common.Analytics.trackEvent("External Error",a.title))}function x(a){if("mouseup"==a.type){var b=document.getElementById("editor_sdk");if(b){var c=b.getBoundingClientRect();G.OnMouseUp(a.x-c.left,a.y-c.top)}}}function y(){G&&G.asc_DownloadAs(c_oAscFileType.PPTX,!0)}function z(){G&&(G.Resize(),G.zoomFitToPage()),W()}function A(a){return a.hasClass("in")}function B(a,c,d){if(G&&G.asc_enableKeyEvents(!c),c){if(d){a.css("display","block");var e,f=d.data("bs.popover"),g=f.tip(),h=f.getPosition(!1),i=g[0].offsetHeight,j="top"===J.toolbarDocked?"bottom":"top";switch(g.removeClass("fade in top bottom left right"),j){case"bottom":e={top:h.top+h.height,left:d.position().left+.5*(d.width()-a.width())};break;default:case"top":e={top:h.top-i,left:d.position().left+.5*(d.width()-a.width())}}g.css(e).addClass(j).addClass("in")}a.hasClass("embed")&&V.show(),a.hasClass("share")&&(U.show(),b())}else a.removeClass("in"),a.css("display","none"),a.hasClass("embed")&&V.hide(),a.hasClass("share")&&U.hide()}function C(){var a=parseInt($("#id-input-embed-width").val()),b=parseInt($("#id-input-embed-height").val());N>a&&(a=N),O>b&&(b=O),$("#id-textarea-embed").text(P.replace("{embed-url}",J.embedUrl).replace("{width}",a).replace("{height}",b)),$("#id-input-embed-width").val(a+"px"),$("#id-input-embed-height").val(b+"px")}function D(a){var b=window.open(a);b&&b.focus()}function E(){if(R)return F;F=this,R=!0;var a;return U.addEventListener("mousedown",function(){$("#id-btn-copy-short").hasClass("copied")||($("#id-btn-copy-short").button("copied"),$("#id-btn-copy-short").addClass("copied"),U.setText($("#id-short-url").val()),setTimeout(function(){$("#id-btn-copy-short").button("reset"),$("#id-btn-copy-short").removeClass("copied")},2e3))}),V.addEventListener("mousedown",function(){$("#id-btn-copy-embed").hasClass("copied")||($("#id-btn-copy-embed").button("copied"),$("#id-btn-copy-embed").addClass("copied"),V.setText($("#id-textarea-embed").text()),setTimeout(function(){$("#id-btn-copy-embed").button("reset"),$("#id-btn-copy-embed").removeClass("copied")},2e3))}),U.glue("id-btn-copy-short"),V.glue("id-btn-copy-embed"),$("#id-btn-copy").on("click",function(){var a=J.saveUrl;"undefined"!=typeof a&&a.length>0?D(a):G&&K.print!==!1&&G.asc_Print($.browser.chrome||$.browser.safari||$.browser.opera),Common.Analytics.trackEvent("Save")}),$("#id-btn-share").on("click",function(a){B($("#id-popover-share"),!A($("#id-popover-share")),$("#id-btn-share")),B($("#id-popover-embed"),!1),a.preventDefault(),a.stopPropagation()}),$("#id-btn-embed").on("click",function(a){B($("#id-popover-embed"),!A($("#id-popover-embed")),$("#id-btn-embed")),B($("#id-popover-share"),!1),a.preventDefault(),a.stopPropagation()}),$("#id-input-embed-width").on("keypress",function(a){13==a.keyCode&&C()}),$("#id-input-embed-height").on("keypress",function(a){13==a.keyCode&&C()}),$("#id-input-embed-width").on("focusin",function(){G&&G.asc_enableKeyEvents(!1)}),$("#id-input-embed-height").on("focusin",function(){G&&G.asc_enableKeyEvents(!1)}),$("#id-input-embed-width").on("focusout",function(){C(),G&&G.asc_enableKeyEvents(!0)}),$("#id-input-embed-height").on("focusout",function(){C(),G&&G.asc_enableKeyEvents(!0)}),$("#page-number").on("keypress",function(a){if(13==a.keyCode){var b=parseInt($("#page-number").val());b>L&&(b=L),(2>b||isNaN(b))&&(b=1),G&&G.goToPage(b-1)}}),$("#id-btn-fullscreen").on("click",function(){D(J.fullscreenUrl)}),$("#id-btn-close").on("click",function(){H.customization&&H.customization.goback&&H.customization.goback.url&&(window.parent.location.href=H.customization.goback.url)}),$("#id-btn-move-left").on("click",function(){G&&S>0&&G.goToPage(S-1)}),$("#id-btn-move-right").on("click",function(){G&&L-1>S&&G.goToPage(S+1)}),$(window).resize(function(){z()}),$(document).click(function(b){b&&b.target&&$(b.target).closest(".popover").length>0||(B($("#id-popover-share"),!1),B($("#id-popover-embed"),!1),clearTimeout(a))}),$(document).mousemove(function(){$("#id-btn-move-left").fadeIn(),$("#id-btn-move-right").fadeIn(),clearTimeout(a),a=setTimeout(function(){$("#id-btn-move-left").fadeOut(),$("#id-btn-move-right").fadeOut()},2e3)}),G=new asc_docs_api("editor_sdk"),G&&(G.CreateComponents(),G.asc_SetFontsPath("../../../../sdkjs/fonts/"),G.SetThemesPath("../../../../sdkjs/slide/themes/"),G.Init(),G.asc_registerCallback("asc_onError",v),G.asc_registerCallback("asc_onDocumentContentReady",q),G.asc_registerCallback("asc_onOpenDocumentProgress",u),G.asc_registerCallback("asc_onCountPages",e),G.asc_registerCallback("asc_onCurrentPage",f),G.asc_registerCallback("asc_onHyperlinkClick",g),G.asc_registerCallback("asc_onStartAction",h),G.asc_registerCallback("asc_onEndAction",i),G.asc_registerCallback("asc_onMouseMoveStart",j),G.asc_registerCallback("asc_onMouseMoveEnd",k),G.asc_registerCallback("asc_onMouseMove",l),G.asc_registerCallback("asc_onDownloadUrl",m),G.asc_registerCallback("asc_onPrint",n),G.asc_registerCallback("asc_onPrintUrl",o),Common.Gateway.on("init",c),Common.Gateway.on("opendocument",d),Common.Gateway.on("showerror",w),Common.Gateway.on("processmouse",x),Common.Gateway.on("downloadas",y),Common.Gateway.ready()),F}var F,G,H={},I={},J={},K={},L=0,M=550,N=400,O=600,P='<iframe allowtransparency="true" frameborder="0" scrolling="no" src="{embed-url}" width="{width}" height="{height}"></iframe>',Q=9090,R=!1,S=0,T=null;if("undefined"!=typeof isBrowserSupported&&!isBrowserSupported())return void Common.Gateway.reportError(void 0,"Your browser is not supported.");ZeroClipboard.setMoviePath("../../../vendor/ZeroClipboard/ZeroClipboard10.swf");var U=new ZeroClipboard.Client,V=new ZeroClipboard.Client;U.zIndex=Q,V.zIndex=Q;var W=a(function(){var a=function(a,b){b?($(a+" button").addClass("no-caption"),$(a+" button span").css("display","none")):($(a+" button").removeClass("no-caption"),$(a+" button span").css("display","inline"))},b=$("#toolbar").width()<M;a("#id-btn-copy",b),a("#id-btn-share",b),a("#id-btn-embed",b)},10);return{create:E,errorDefaultMessage:"Error code: %1",unknownErrorText:"Unknown error.",convertationTimeoutText:"Convertation timeout exceeded.",convertationErrorText:"Convertation failed.",downloadErrorText:"Download failed.",criticalErrorTitle:"Error",notcriticalErrorTitle:"Warning"}};!function(a){a(function(){ApplicationView.create(),ApplicationController.create()})}(window.jQuery);